<!DOCTYPE html>
<html lang="en">

<!-- HEAD -->
<head>
    <title>Big Houses</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<!-- CONTENT -->
<body>
    <!-- Link to / -->
    <header class="header">
        <div class="header-left">
            <a href="/"> <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo"> </a>
            <h2>Big Houses</h2>
        </div>

        <!-- Include a link to /explore/ and /users/{logname}/. -->
        <div class="header-right">
            <a href="/explore/" class="nav-link">Explore</a>
            <a href="/users/{{ logname }}/" class="nav-link">{{ logname }}</a>
        </div>
    </header>

    <main class="housing-detail-container">
        <div class="housing-detail-card">
            <!-- Left Column: Images and Amenities -->
            <div class="left-column">
                <!-- Image Gallery -->
                <div class="image-gallery">
                    {% if post.images %}
                        <div class="main-image">
                            <img src="/uploads/{{ post.images[0].img_url }}" alt="Property image" id="mainImage">
                        </div>
                        {% if post.images|length > 1 %}
                            <div class="thumbnail-strip">
                                {% for image in post.images %}
                                    <img src="/uploads/{{ image.img_url }}" alt="Property thumbnail" 
                                         class="thumbnail {% if loop.index0 == 0 %}active{% endif %}" 
                                         onclick="changeMainImage('{{ image.img_url }}', this)">
                                {% endfor %}
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="no-images">
                            <p>No images available</p>
                        </div>
                    {% endif %}
                </div>

                <!-- Amenities -->
                <div class="amenities-section">
                    <h3>Amenities</h3>
                    <div class="amenities-grid">
                        {% if post.wifi_included %}
                            <div class="amenity">üì∂ WiFi Included</div>
                        {% endif %}
                        {% if post.laundry %}
                            <div class="amenity">üß∫ Laundry</div>
                        {% endif %}
                        {% if post.parking %}
                            <div class="amenity">üÖøÔ∏è Parking</div>
                        {% endif %}
                        {% if post.pets_allowed %}
                            <div class="amenity">üê∂ Pets Allowed</div>
                        {% endif %}
                        {% if post.furnished %}
                            <div class="amenity">üõãÔ∏è Furnished</div>
                        {% endif %}
                        {% if post.air_conditioning %}
                            <div class="amenity">‚ùÑÔ∏è Air Conditioning</div>
                        {% endif %}
                        {% if post.heating %}
                            <div class="amenity">üî• Heating</div>
                        {% endif %}
                        {% if post.utilities_included %}
                            <div class="amenity">üí° Utilities Included</div>
                        {% endif %}
                        {% if post.weed_friendly %}
                            <div class="amenity">üåø Weed Friendly</div>
                        {% endif %}
                        {% if post.smoking_friendly %}
                            <div class="amenity">üö¨ Smoking Friendly</div>
                        {% endif %}
                        {% if post.drinking_friendly %}
                            <div class="amenity">üç∫ Drinking Friendly</div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Housing Information -->
            <div class="housing-info">
                <div class="price-section">
                    <h1 class="price">${{ "%.0f"|format(post.monthly_rent) }}/month</h1>
                    <div class="property-type">{{ post.house_type }} ‚Ä¢ {{ post.room_type }}</div>
                </div>

                <!-- Address -->
                <div class="address-section">
                    <h2 class="address">{{ post.street_address }}</h2>
                    <p class="location">{{ post.city }}, {{ post.state }} {{ post.zip_code }}</p>
                </div>

                <!-- Property Details -->
                <div class="property-details">
                    <h3>Property Details</h3>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="label">Property Type:</span>
                            <span class="value">{{ post.house_type }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Room Type:</span>
                            <span class="value">{{ post.room_type }}</span>
                        </div>
                        {% if post.gender %}
                        <div class="detail-item">
                            <span class="label">Gender Preference:</span>
                            <span class="value">{{ post.gender }}</span>
                        </div>
                        {% endif %}
                        {% if post.availability_start %}
                        <div class="detail-item">
                            <span class="label">Available From:</span>
                            <span class="value">{{ post.availability_start }}</span>
                        </div>
                        {% endif %}
                        {% if post.availability_end %}
                        <div class="detail-item">
                            <span class="label">Available Until:</span>
                            <span class="value">{{ post.availability_end }}</span>
                        </div>
                        {% endif %}
                        {% if post.distance_from_campus %}
                        <div class="detail-item">
                            <span class="label">Distance to Campus:</span>
                            <span class="value">{{ "%.1f"|format(post.distance_from_campus) }} miles</span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="contact-section">
                    <h3>Contact</h3>
                    <div class="contact-info">
                        <a href="/users/{{ post.contact_student_uniqname }}/" class="contact-profile">
                            <img src="{{ url_for('uploaded_file', filename=post.contact_img_url) }}" alt="Contact profile" class="contact-avatar">
                            <div class="contact-details">
                                <div class="contact-name">{{ post.contact_name or post.contact_student_uniqname }}</div>
                                <div class="contact-username">@{{ post.contact_student_uniqname }}</div>
                            </div>
                        </a>
                        <a href="/users/{{ post.contact_student_uniqname }}/" class="contact-btn">Contact</a>
                    </div>
                </div>

                <!-- Actions (for owner) -->
                {% if post.contact_student_uniqname == logname %}
                <div class="owner-actions">
                    <form action="{{ url_for('post')}}?target=/posts/{{ post.housing_id }}/" method="post" enctype="multipart/form-data">
                        <input type="hidden" name="operation" value="delete"/>
                        <input type="hidden" name="housing_id" value="{{ post.housing_id }}"/>
                        <button type="submit" name="delete" class="delete-listing-btn">Delete Listing</button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
    </main>

    <script>
        function changeMainImage(imageSrc, thumbnail) {
            document.getElementById('mainImage').src = '/uploads/' + imageSrc;
            
            // Remove active class from all thumbnails
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            
            // Add active class to clicked thumbnail
            thumbnail.classList.add('active');
        }
    </script>

</body>
</html>

